---
layout: default
---
{% comment %} Page layout with special profile mode. {% endcomment %}
{% assign is_profile = false %}
{% if page.url contains '/profiles/' %}
  {% assign is_profile = true %}
{% endif %}
{% assign has_profile_image = false %}
{% if is_profile %}
  {% assign img_path = page.img | default: page.image | default: page.img_path %}
  {% if img_path %}{% assign has_profile_image = true %}{% endif %}
{% endif %}

{% if is_profile and has_profile_image %}
  <div class="row mb-4 align-items-start profile-layout-row">
    <div class="col-12 col-lg-2 col-md-3 d-none d-md-block">
      {% include profiles-toc.liquid %}
    </div>
    <div class="col-12 col-lg-3 col-md-4 mb-3 mb-md-0">
      {% include figure.liquid path=img_path class='img-fluid rounded mx-auto d-block profile-hero avatar' alt=page.title cache_bust=true width='480' %}
    </div>
    <div class="col-12 col-lg-7 col-md-8 profile-main-col">
      <article>
        <div class="profile">
          {{ content }}
        </div>
        {%- comment -%}
          Articles by this profile
          Match posts where any author slug equals this profile's title slug.
        {%- endcomment -%}
        {% assign prof_slug = page.title | slugify %}
        {% assign posts_by_profile = '' %}
        {% assign has_posts = false %}
        <div class="mt-4">
          <h3>Articles by {{ page.title }}</h3>
          <ul class="list-unstyled">
            {% for post in site.posts %}
              {% assign author_list = null %}
              {% if post.author %}
                {% assign author_list = post.author | split: '||' %}
              {% elsif post.authors %}
                {% assign author_list = post.authors %}
              {% endif %}
              {% if author_list %}
                {% assign matches_profile = false %}
                {% for a in author_list %}
                  {% assign a_slug = a | strip | slugify %}
                  {% if a_slug == prof_slug %}
                    {% assign matches_profile = true %}
                  {% endif %}
                {% endfor %}
                {% if matches_profile %}
                  {% assign has_posts = true %}
                  <li class="mb-2">
                    <span class="text-muted" style="width: 9rem; display: inline-block;">{{ post.date | date: '%b %d, %Y' }}</span>
                    <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                  </li>
                {% endif %}
              {% endif %}
            {% endfor %}
            {% if has_posts == false %}
              <li class="text-muted">No articles yet.</li>
            {% endif %}
          </ul>
        </div>
        {% assign profiles = site.profiles | sort: 'title' %}
        {% assign idx = null %}
        {% for p in profiles %}
          {% if p.url == page.url %}{% assign idx = forloop.index0 %}{% endif %}
        {% endfor %}
        {% if idx != null %}
          {% assign prev_profile = null %}
          {% assign next_profile = null %}
          {% if idx > 0 %}
            {% assign prev_index = idx | minus: 1 %}
            {% assign prev_profile = profiles[prev_index] %}
          {% endif %}
          {% assign last_index = profiles | size | minus: 1 %}
          {% if idx < last_index %}
            {% assign next_index = idx | plus: 1 %}
            {% assign next_profile = profiles[next_index] %}
          {% endif %}
        {% endif %}
        {% if prev_profile or next_profile %}
          <nav class="profile-nav mt-4 d-flex justify-content-between d-md-none">
            {% if prev_profile -%}
              <a class="btn btn-outline-primary" href="{{ prev_profile.url | relative_url }}">&larr; {{ prev_profile.title }}</a>
            {%- else -%}
              <span></span>
            {%- endif %}
            {% if next_profile -%}
              <a class="btn btn-outline-primary" href="{{ next_profile.url | relative_url }}">{{ next_profile.title }} &rarr;</a>
            {%- else -%}
              <span></span>
            {%- endif %}
          </nav>
        {% endif %}
      </article>
    </div>
  </div>
{% elsif is_profile %}
  <div class="row mb-4 align-items-start profile-layout-row">
    <div class="col-12 col-lg-2 col-md-3 d-none d-md-block">
      {% include profiles-toc.liquid %}
    </div>
    <div class="col-12 col-lg-10 col-md-9 profile-main-col">
      <article>
        <div class="profile">
          {{ content }}
        </div>
        {%- comment -%}
          Articles by this profile (no image variant)
        {%- endcomment -%}
        {% assign prof_slug = page.title | slugify %}
        {% assign has_posts = false %}
        <div class="mt-4">
          <h3>Articles by {{ page.title }}</h3>
          <ul class="list-unstyled">
            {% for post in site.posts %}
              {% assign author_list = null %}
              {% if post.author %}
                {% assign author_list = post.author | split: '||' %}
              {% elsif post.authors %}
                {% assign author_list = post.authors %}
              {% endif %}
              {% if author_list %}
                {% assign matches_profile = false %}
                {% for a in author_list %}
                  {% assign a_slug = a | strip | slugify %}
                  {% if a_slug == prof_slug %}
                    {% assign matches_profile = true %}
                  {% endif %}
                {% endfor %}
                {% if matches_profile %}
                  {% assign has_posts = true %}
                  <li class="mb-2">
                    <span class="text-muted" style="width: 9rem; display: inline-block;">{{ post.date | date: '%b %d, %Y' }}</span>
                    <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                  </li>
                {% endif %}
              {% endif %}
            {% endfor %}
            {% if has_posts == false %}
              <li class="text-muted">No articles yet.</li>
            {% endif %}
          </ul>
        </div>
      </article>
    </div>
  </div>
{% else %}
  {% if page.img %}
    {% include figure.liquid path=page.img class='img-fluid rounded mx-auto d-block' alt=page.title cache_bust=true %}
  {% endif %}
  <article>{{ content }}</article>
{% endif %}

{% if site.giscus and page.giscus_comments %}{% include giscus.liquid %}{% endif %}
